var Diff;Diff=function(){function e(){}return e.prototype.calculateDifferences=function(e,t,r,n){var c,o,u;return null==r&&(r=""),null==n&&(n=[]),c=this._getType(t),o=this._getType(e),""!==r&&(u={key:r,valueType:c},n=n.concat([u])),e?t?o!==c?[this._createDifference("change",n,t)]:"object"==typeof e?this._getNestedDifferences(e,t,r,n):t!==e?[this._createDifference("change",n,t)]:[]:[this._createDifference("delete",n)]:[this._createDifference("added",n,t)]},e.prototype._createDifference=function(e,t,r){return{type:e,path:t,value:r}},e.prototype._getNestedDifferences=function(e,t,r,n){var c,o;return null==r&&(r=""),null==n&&(n=[]),c=this._union(Object.keys(e),Object.keys(t)),o=c.map(function(r){return function(c){return r.calculateDifferences(e[c],t[c],c,n)}}(this)),this._flatten(o)},e.prototype._union=function(e,t){return e.concat(t.filter(function(t){return-1===e.indexOf(t)}))},e.prototype._flatten=function(e){return e.reduce(function(e,t){return e.concat(t)},[])},e.prototype._getType=function(e){var t;return t=typeof e,"object"===t&&this._isArray(e)?"array":t},e.prototype._isArray=function(e){return"[object Array]"==={}.toString.call(e)},e.prototype.applyDifferences=function(e,t){return t.forEach(function(t){return function(r){var n,c;return n=r.path.pop().key,c=r.path.reduce(function(e,r){return e[r.key]||t._createValue(e,r.key,r.valueType),e[r.key]},e),"change"===r.type||"added"===r.type?c[n]=r.value:delete c[n]}}(this)),e},e.prototype._createValue=function(e,t,r){return e[t]=this._createFromType(r)},e.prototype._createFromType=function(e){return"object"===e?{}:"array"===e?[]:void 0},e}(),module.exports=new Diff;